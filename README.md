# WebRTC P2P 文件传输（Lite）

轻量浏览器端 P2P 文件传输示例：

- 前端：React（无打包构建，CDN ESM）
- 传输：WebRTC DataChannel
- 信令：Node.js + WebSocket
- 功能：房间号 + 密码连接、进度条、大文件分片、断点续传（基于 IndexedDB 持久化）、SHA-256 完整性校验

## 1. 安装与启动

```bash
npm install
npm start
```

打开浏览器访问：

`http://localhost:8080`

## 2. 使用方式

1. 在两个浏览器标签页（或两台设备）打开页面。
2. 两端输入同一个房间号和同一个房间密码，点击“连接房间”。
3. 一端选择文件并点击“开始发送”。
4. 可在发送端暂停/继续，连接中断后可重连并继续传输。
5. 接收完成后点击下载链接保存文件。

## 3. 断点续传说明

- 接收端分片会持久化到 IndexedDB。
- 接收端会记录已接收的连续分片数量到 localStorage。
- 重连后，发送端重新发送文件元信息，接收端返回断点索引，发送端从断点继续。

## 4. 简单鉴权说明

- 第一个进入房间的用户会用输入的密码初始化房间。
- 后续加入者必须使用相同密码，否则会被拒绝（`auth-failed`）。
- 服务端仅保存密码的 SHA-256 哈希，不保存明文。

## 5. 传输校验（SHA-256）

- 发送端在开始传输前计算文件 SHA-256，并随文件元信息发送。
- 接收端合并文件后再次计算 SHA-256，只有一致才提供下载链接。

## 6. 轻量化设计

- 不引入前端打包工具和复杂框架。
- 信令服务仅实现必要房间和转发逻辑（最多 2 人）。
- 采用固定分片大小与 DataChannel 背压控制，代码路径简洁。
